{"remainingRequest":"/home/lxt/SupplyChain-master/iview-admin/node_modules/babel-loader/lib/index.js!/home/lxt/SupplyChain-master/iview-admin/node_modules/cache-loader/dist/cjs.js??ref--0-0!/home/lxt/SupplyChain-master/iview-admin/node_modules/vue-loader/lib/index.js??vue-loader-options!/home/lxt/SupplyChain-master/iview-admin/src/components/main/components/tags-nav/tags-nav.vue?vue&type=script&lang=js&","dependencies":[{"path":"/home/lxt/SupplyChain-master/iview-admin/src/components/main/components/tags-nav/tags-nav.vue","mtime":1583204240000},{"path":"/home/lxt/SupplyChain-master/iview-admin/.babelrc","mtime":1583204240000},{"path":"/home/lxt/SupplyChain-master/iview-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/lxt/SupplyChain-master/iview-admin/node_modules/babel-loader/lib/index.js","mtime":315532800000},{"path":"/home/lxt/SupplyChain-master/iview-admin/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/lxt/SupplyChain-master/iview-admin/node_modules/vue-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":["import \"core-js/modules/web.dom.iterable\";\nimport \"core-js/modules/es7.array.includes\";\nimport \"core-js/modules/es6.string.includes\";\nimport \"core-js/modules/es6.function.name\";\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\nimport { showTitle, routeEqual } from '@/libs/util';\nimport beforeClose from '@/router/before-close';\nexport default {\n  name: 'TagsNav',\n  props: {\n    value: Object,\n    list: {\n      type: Array,\n      default: function _default() {\n        return [];\n      }\n    }\n  },\n  data: function data() {\n    return {\n      tagBodyLeft: 0,\n      rightOffset: 40,\n      outerPadding: 4,\n      contextMenuLeft: 0,\n      contextMenuTop: 0,\n      visible: false,\n      menuList: {\n        others: '关闭其他',\n        all: '关闭所有'\n      }\n    };\n  },\n  computed: {\n    currentRouteObj: function currentRouteObj() {\n      var _this$value = this.value,\n          name = _this$value.name,\n          params = _this$value.params,\n          query = _this$value.query;\n      return {\n        name: name,\n        params: params,\n        query: query\n      };\n    }\n  },\n  methods: {\n    handlescroll: function handlescroll(e) {\n      var type = e.type;\n      var delta = 0;\n\n      if (type === 'DOMMouseScroll' || type === 'mousewheel') {\n        delta = e.wheelDelta ? e.wheelDelta : -(e.detail || 0) * 40;\n      }\n\n      this.handleScroll(delta);\n    },\n    handleScroll: function handleScroll(offset) {\n      var outerWidth = this.$refs.scrollOuter.offsetWidth;\n      var bodyWidth = this.$refs.scrollBody.offsetWidth;\n\n      if (offset > 0) {\n        this.tagBodyLeft = Math.min(0, this.tagBodyLeft + offset);\n      } else {\n        if (outerWidth < bodyWidth) {\n          if (this.tagBodyLeft < -(bodyWidth - outerWidth)) {\n            this.tagBodyLeft = this.tagBodyLeft;\n          } else {\n            this.tagBodyLeft = Math.max(this.tagBodyLeft + offset, outerWidth - bodyWidth);\n          }\n        } else {\n          this.tagBodyLeft = 0;\n        }\n      }\n    },\n    handleTagsOption: function handleTagsOption(type) {\n      var _this = this;\n\n      if (type.includes('all')) {\n        // 关闭所有，除了home\n        var res = this.list.filter(function (item) {\n          return item.name === _this.$config.homeName;\n        });\n        this.$emit('on-close', res, 'all');\n      } else if (type.includes('others')) {\n        // 关闭除当前页和home页的其他页\n        var _res = this.list.filter(function (item) {\n          return routeEqual(_this.currentRouteObj, item) || item.name === _this.$config.homeName;\n        });\n\n        this.$emit('on-close', _res, 'others', this.currentRouteObj);\n        setTimeout(function () {\n          _this.getTagElementByRoute(_this.currentRouteObj);\n        }, 100);\n      }\n    },\n    handleClose: function handleClose(current) {\n      var _this2 = this;\n\n      if (current.meta && current.meta.beforeCloseName && current.meta.beforeCloseName in beforeClose) {\n        new Promise(beforeClose[current.meta.beforeCloseName]).then(function (close) {\n          if (close) {\n            _this2.close(current);\n          }\n        });\n      } else {\n        this.close(current);\n      }\n    },\n    close: function close(route) {\n      var res = this.list.filter(function (item) {\n        return !routeEqual(route, item);\n      });\n      this.$emit('on-close', res, undefined, route);\n    },\n    handleClick: function handleClick(item) {\n      this.$emit('input', item);\n    },\n    showTitleInside: function showTitleInside(item) {\n      return showTitle(item, this);\n    },\n    isCurrentTag: function isCurrentTag(item) {\n      return routeEqual(this.currentRouteObj, item);\n    },\n    moveToView: function moveToView(tag) {\n      var outerWidth = this.$refs.scrollOuter.offsetWidth;\n      var bodyWidth = this.$refs.scrollBody.offsetWidth;\n\n      if (bodyWidth < outerWidth) {\n        this.tagBodyLeft = 0;\n      } else if (tag.offsetLeft < -this.tagBodyLeft) {\n        // 标签在可视区域左侧\n        this.tagBodyLeft = -tag.offsetLeft + this.outerPadding;\n      } else if (tag.offsetLeft > -this.tagBodyLeft && tag.offsetLeft + tag.offsetWidth < -this.tagBodyLeft + outerWidth) {\n        // 标签在可视区域\n        this.tagBodyLeft = Math.min(0, outerWidth - tag.offsetWidth - tag.offsetLeft - this.outerPadding);\n      } else {\n        // 标签在可视区域右侧\n        this.tagBodyLeft = -(tag.offsetLeft - (outerWidth - this.outerPadding - tag.offsetWidth));\n      }\n    },\n    getTagElementByRoute: function getTagElementByRoute(route) {\n      var _this3 = this;\n\n      this.$nextTick(function () {\n        _this3.refsTag = _this3.$refs.tagsPageOpened;\n\n        _this3.refsTag.forEach(function (item, index) {\n          if (routeEqual(route, item.$attrs['data-route-item'])) {\n            var tag = _this3.refsTag[index].$el;\n\n            _this3.moveToView(tag);\n          }\n        });\n      });\n    },\n    contextMenu: function contextMenu(item, e) {\n      if (item.name === this.$config.homeName) {\n        return;\n      }\n\n      this.visible = true;\n      var offsetLeft = this.$el.getBoundingClientRect().left;\n      this.contextMenuLeft = e.clientX - offsetLeft + 10;\n      this.contextMenuTop = e.clientY - 64;\n    },\n    closeMenu: function closeMenu() {\n      this.visible = false;\n    }\n  },\n  watch: {\n    '$route': function $route(to) {\n      this.getTagElementByRoute(to);\n    },\n    visible: function visible(value) {\n      if (value) {\n        document.body.addEventListener('click', this.closeMenu);\n      } else {\n        document.body.removeEventListener('click', this.closeMenu);\n      }\n    }\n  },\n  mounted: function mounted() {\n    var _this4 = this;\n\n    setTimeout(function () {\n      _this4.getTagElementByRoute(_this4.$route);\n    }, 200);\n  }\n};",null]}